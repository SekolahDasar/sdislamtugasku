<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistem Dapodik Sekolah</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
        /* Tailwind CSS Classes - Inline untuk kompatibilitas */
        .min-h-full { min-height: 100%; }
        .h-full { height: 100%; }
        .w-full { width: 100%; }
        .max-w-md { max-width: 28rem; }
        .max-w-7xl { max-width: 80rem; }
        .max-w-2xl { max-width: 42rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .flex { display: flex; }
        .grid { display: grid; }
        .hidden { display: none; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .space-y-8 > * + * { margin-top: 2rem; }
        .space-y-6 > * + * { margin-top: 1.5rem; }
        .space-y-4 > * + * { margin-top: 1rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-x-8 > * + * { margin-left: 2rem; }
        .space-x-4 > * + * { margin-left: 1rem; }
        .space-x-3 > * + * { margin-left: 0.75rem; }
        .space-x-2 > * + * { margin-left: 0.5rem; }
        .bg-gradient-to-br { background: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
        .from-blue-600 { --tw-gradient-from: #2563eb; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(37, 99, 235, 0)); }
        .to-blue-800 { --tw-gradient-to: #1e40af; }
        .bg-gray-50 { background-color: #f9fafb; }
        .bg-white { background-color: #ffffff; }
        .bg-blue-600 { background-color: #2563eb; }
        .bg-blue-500 { background-color: #3b82f6; }
        .bg-green-600 { background-color: #16a34a; }
        .bg-red-600 { background-color: #dc2626; }
        .bg-gray-500 { background-color: #6b7280; }
        .hover\:bg-blue-700:hover { background-color: #1d4ed8; }
        .hover\:bg-green-700:hover { background-color: #15803d; }
        .hover\:bg-red-700:hover { background-color: #b91c1c; }
        .hover\:bg-gray-600:hover { background-color: #4b5563; }
        .text-white { color: #ffffff; }
        .text-blue-600 { color: #2563eb; }
        .text-blue-100 { color: #dbeafe; }
        .text-gray-900 { color: #111827; }
        .text-gray-700 { color: #374151; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-500 { color: #6b7280; }
        .text-red-700 { color: #b91c1c; }
        .text-green-800 { color: #166534; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-md { border-radius: 0.375rem; }
        .rounded-full { border-radius: 9999px; }
        .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
        .border { border-width: 1px; }
        .border-b { border-bottom-width: 1px; }
        .border-b-2 { border-bottom-width: 2px; }
        .border-gray-300 { border-color: #d1d5db; }
        .border-gray-200 { border-color: #e5e7eb; }
        .border-blue-500 { border-color: #3b82f6; }
        .border-transparent { border-color: transparent; }
        .p-8 { padding: 2rem; }
        .p-6 { padding: 1.5rem; }
        .p-5 { padding: 1.25rem; }
        .p-4 { padding: 1rem; }
        .p-3 { padding: 0.75rem; }
        .p-2 { padding: 0.5rem; }
        .px-8 { padding-left: 2rem; padding-right: 2rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-1 { padding-left: 0.25rem; padding-right: 0.25rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
        .mt-8 { margin-top: 2rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-3 { margin-top: 0.75rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mr-3 { margin-right: 0.75rem; }
        .mr-2 { margin-right: 0.5rem; }
        .ml-3 { margin-left: 0.75rem; }
        .ml-2 { margin-left: 0.5rem; }
        .ml-5 { margin-left: 1.25rem; }
        .ml-auto { margin-left: auto; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .font-bold { font-weight: 700; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .uppercase { text-transform: uppercase; }
        .tracking-wider { letter-spacing: 0.05em; }
        .focus\:outline-none:focus { outline: 2px solid transparent; outline-offset: 2px; }
        .focus\:ring-2:focus { box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); }
        .focus\:ring-blue-500:focus { box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); }
        .focus\:border-blue-500:focus { border-color: #3b82f6; }
        .transition { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
        .duration-200 { transition-duration: 200ms; }
        .cursor-pointer { cursor: pointer; }
        .resize-none { resize: none; }
        .overflow-hidden { overflow: hidden; }
        .overflow-x-auto { overflow-x: auto; }
        .overflow-y-auto { overflow-y: auto; }
        .whitespace-nowrap { white-space: nowrap; }
        .truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .divide-y > * + * { border-top-width: 1px; }
        .divide-gray-200 > * + * { border-top-color: #e5e7eb; }
        .min-w-full { min-width: 100%; }
        .w-96 { width: 24rem; }
        .w-24 { width: 6rem; }
        .w-20 { width: 5rem; }
        .w-12 { width: 3rem; }
        .w-10 { width: 2.5rem; }
        .w-8 { width: 2rem; }
        .w-6 { width: 1.5rem; }
        .w-5 { width: 1.25rem; }
        .w-4 { width: 1rem; }
        .w-0 { width: 0px; }
        .h-24 { height: 6rem; }
        .h-20 { height: 5rem; }
        .h-12 { height: 3rem; }
        .h-10 { height: 2.5rem; }
        .h-8 { height: 2rem; }
        .h-6 { height: 1.5rem; }
        .h-5 { height: 1.25rem; }
        .h-4 { height: 1rem; }
        .h-20 { height: 5rem; }
        .flex-1 { flex: 1 1 0%; }
        .flex-shrink-0 { flex-shrink: 0; }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .gap-6 { gap: 1.5rem; }
        .gap-4 { gap: 1rem; }
        .gap-2 { gap: 0.5rem; }
        .col-span-3 { grid-column: span 3 / span 3; }
        .inline-flex { display: inline-flex; }
        .inline { display: inline; }
        .block { display: block; }
        .fixed { position: fixed; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .inset-0 { top: 0px; right: 0px; bottom: 0px; left: 0px; }
        .top-20 { top: 5rem; }
        .top-10 { top: 2.5rem; }
        .top-4 { top: 1rem; }
        .right-4 { right: 1rem; }
        .z-50 { z-index: 50; }
        .object-cover { object-fit: cover; }
        .bg-opacity-50 { --tw-bg-opacity: 0.5; }
        .bg-opacity-30 { --tw-bg-opacity: 0.3; }
        .disabled\:opacity-50:disabled { opacity: 0.5; }
        .disabled\:cursor-not-allowed:disabled { cursor: not-allowed; }
        .hover\:text-gray-700:hover { color: #374151; }
        .hover\:border-gray-300:hover { border-color: #d1d5db; }
        .hover\:text-blue-900:hover { color: #1e3a8a; }
        .hover\:text-red-900:hover { color: #7f1d1d; }
        .hover\:bg-gray-50:hover { background-color: #f9fafb; }
        .hover\:bg-blue-50:hover { background-color: #eff6ff; }
        .hover\:border-blue-500:hover { border-color: #3b82f6; }
        .hover\:border-gray-400:hover { border-color: #9ca3af; }
        .hover\:text-blue-500:hover { color: #3b82f6; }
        .hover\:text-green-700:hover { color: #15803d; }
        .last\:border-b-0:last-child { border-bottom-width: 0px; }
        .bg-red-50 { background-color: #fef2f2; }
        .bg-green-50 { background-color: #f0fdf4; }
        .bg-yellow-50 { background-color: #fefce8; }
        .bg-blue-50 { background-color: #eff6ff; }
        .bg-gray-100 { background-color: #f3f4f6; }
        .bg-green-100 { background-color: #dcfce7; }
        .bg-red-100 { background-color: #fee2e2; }
        .bg-blue-100 { background-color: #dbeafe; }
        .bg-orange-100 { background-color: #fed7aa; }
        .bg-purple-100 { background-color: #e9d5ff; }
        .bg-yellow-100 { background-color: #fef3c7; }
        .border-red-200 { border-color: #fecaca; }
        .border-green-200 { border-color: #bbf7d0; }
        .border-yellow-200 { border-color: #fde68a; }
        .border-dashed { border-style: dashed; }
        .border-2 { border-width: 2px; }
        .text-red-600 { color: #dc2626; }
        .text-green-600 { color: #16a34a; }
        .text-orange-600 { color: #ea580c; }
        .text-purple-600 { color: #9333ea; }
        .text-yellow-400 { color: #facc15; }
        .text-yellow-800 { color: #92400e; }
        .text-yellow-700 { color: #a16207; }
        .text-green-700 { color: #15803d; }
        .text-blue-700 { color: #1d4ed8; }
        .text-red-900 { color: #7f1d1d; }
        .text-gray-400 { color: #9ca3af; }
        .from-green-500 { --tw-gradient-from: #22c55e; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(34, 197, 94, 0)); }
        .to-green-600 { --tw-gradient-to: #16a34a; }
        .from-orange-500 { --tw-gradient-from: #f97316; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(249, 115, 22, 0)); }
        .to-orange-600 { --tw-gradient-to: #ea580c; }
        .from-purple-500 { --tw-gradient-from: #a855f7; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(168, 85, 247, 0)); }
        .to-purple-600 { --tw-gradient-to: #9333ea; }
        .from-blue-500 { --tw-gradient-from: #3b82f6; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(59, 130, 246, 0)); }
        .bg-blue-400 { background-color: #60a5fa; }
        .bg-green-400 { background-color: #4ade80; }
        .bg-orange-400 { background-color: #fb923c; }
        .bg-purple-400 { background-color: #c084fc; }
        .pt-4 { padding-top: 1rem; }
        .border-t { border-top-width: 1px; }
        .max-h-64 { max-height: 16rem; }

        /* Media Queries untuk Responsif */
        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }
        
        @media (min-width: 1024px) {
            .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
            .lg\:px-8 { padding-left: 2rem; padding-right: 2rem; }
        }

        @media (min-width: 640px) {
            .sm\:px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        }
    </style>
  <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loading-spinner {
            border: 2px solid #f3f4f6;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gray-50"><!-- Login Page -->
  <div id="login-page" class="min-h-full bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center px-4">
   <div class="max-w-md w-full space-y-8">
    <div class="text-center">
     <div class="mx-auto h-20 w-20 bg-white rounded-full flex items-center justify-center mb-4">
      <svg class="w-12 h-12 text-blue-600" fill="currentColor" viewbox="0 0 20 20"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z" />
      </svg>
     </div>
     <h2 class="text-3xl font-bold text-white">Sistem Dapodik</h2>
     <p class="mt-2 text-blue-100">Silakan login untuk mengakses sistem</p>
    </div>
    <div class="bg-white rounded-lg shadow-xl p-8">
     <form onsubmit="handleLogin(event)" class="space-y-6">
      <div id="login-error" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm">
       Username atau password salah!
      </div>
      <div><label for="username" class="block text-sm font-medium text-gray-700 mb-2">Username</label> <input type="text" id="username" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan username">
      </div>
      <div><label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label> <input type="password" id="password" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan password">
      </div><button type="submit" id="login-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center"> <span class="login-text">Masuk</span>
       <div class="loading-spinner ml-2 hidden"></div></button>
     </form>
     <div class="mt-6 p-4 bg-gray-50 rounded-md">
      <p class="text-sm text-gray-600 font-medium mb-2">Demo Login:</p>
      <p class="text-xs text-gray-500">Username: <span class="font-mono bg-gray-200 px-1 rounded">admin</span></p>
      <p class="text-xs text-gray-500">Password: <span class="font-mono bg-gray-200 px-1 rounded">admin123</span></p>
     </div>
    </div>
   </div>
  </div><!-- Main Application -->
  <div id="main-app" class="min-h-full hidden"><!-- Header -->
   <header class="bg-blue-600 shadow-lg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex justify-between items-center py-4">
      <div class="flex items-center">
       <div class="bg-white p-2 rounded-lg mr-3">
        <svg class="w-8 h-8 text-blue-600" fill="currentColor" viewbox="0 0 20 20"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z" />
        </svg>
       </div>
       <div>
        <h1 id="nama-sekolah" class="text-xl font-bold text-white">SDN Merdeka 01</h1>
        <p id="alamat-sekolah" class="text-blue-100 text-sm">Jl. Pendidikan No. 123, Jakarta</p>
       </div>
      </div>
      <div class="flex items-center space-x-4">
       <div class="text-right">
        <p class="text-white font-medium">Kepala Sekolah</p>
        <p id="kepala-sekolah" class="text-blue-100 text-sm">Drs. Ahmad Wijaya, M.Pd</p>
       </div><button onclick="handleLogout()" class="bg-blue-500 hover:bg-blue-400 text-white px-3 py-1 rounded-md text-sm font-medium transition duration-200"> Logout </button>
      </div>
     </div>
    </div>
   </header><!-- Navigation -->
   <nav class="bg-white shadow-sm border-b">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex space-x-8"><button onclick="showTab('beranda')" id="tab-beranda" class="py-4 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600"> Beranda </button> <button onclick="showTab('siswa')" id="tab-siswa" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"> Data Siswa </button> <button onclick="showTab('guru')" id="tab-guru" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"> Data Guru </button> <button onclick="showTab('tendik')" id="tab-tendik" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"> Data Tendik </button> <button onclick="showTab('kelas')" id="tab-kelas" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"> Data Kelas </button> <button onclick="showTab('pengaturan')" id="tab-pengaturan" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"> Pengaturan </button>
     </div>
    </div>
   </nav><!-- Main Content -->
   <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"><!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
     <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
       <div class="flex items-center">
        <div class="flex-shrink-0">
         <svg class="h-6 w-6 text-blue-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
         </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
         <dl>
          <dt class="text-sm font-medium text-gray-500 truncate">
           Total Siswa
          </dt>
          <dd id="total-siswa" class="text-lg font-medium text-gray-900">
           0
          </dd>
         </dl>
        </div>
       </div>
      </div>
     </div>
     <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
       <div class="flex items-center">
        <div class="flex-shrink-0">
         <svg class="h-6 w-6 text-green-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
         </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
         <dl>
          <dt class="text-sm font-medium text-gray-500 truncate">
           Total Guru
          </dt>
          <dd id="total-guru" class="text-lg font-medium text-gray-900">
           0
          </dd>
         </dl>
        </div>
       </div>
      </div>
     </div>
     <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
       <div class="flex items-center">
        <div class="flex-shrink-0">
         <svg class="h-6 w-6 text-orange-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2V6z" />
         </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
         <dl>
          <dt class="text-sm font-medium text-gray-500 truncate">
           Total Tendik
          </dt>
          <dd id="total-tendik" class="text-lg font-medium text-gray-900">
           0
          </dd>
         </dl>
        </div>
       </div>
      </div>
     </div>
     <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
       <div class="flex items-center">
        <div class="flex-shrink-0">
         <svg class="h-6 w-6 text-purple-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
         </svg>
        </div>
        <div class="ml-5 w-0 flex-1">
         <dl>
          <dt class="text-sm font-medium text-gray-500 truncate">
           Total Kelas
          </dt>
          <dd id="total-kelas" class="text-lg font-medium text-gray-900">
           0
          </dd>
         </dl>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Content Sections -->
    <div class="bg-white shadow rounded-lg"><!-- Beranda Section -->
     <div id="section-beranda" class="fade-in">
      <div class="px-6 py-4 border-b border-gray-200">
       <h2 class="text-lg font-medium text-gray-900">Dashboard Rekap Data</h2>
      </div>
      <div class="p-6"><!-- Summary Cards -->
       <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-6 text-white">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-blue-100 text-sm">Siswa Aktif</p>
           <p id="dashboard-siswa" class="text-2xl font-bold">0</p>
          </div>
          <div class="bg-blue-400 bg-opacity-30 rounded-full p-3">
           <svg class="w-6 h-6" fill="currentColor" viewbox="0 0 20 20"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
           </svg>
          </div>
         </div>
        </div>
        <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-green-100 text-sm">Guru Aktif</p>
           <p id="dashboard-guru" class="text-2xl font-bold">0</p>
          </div>
          <div class="bg-green-400 bg-opacity-30 rounded-full p-3">
           <svg class="w-6 h-6" fill="currentColor" viewbox="0 0 20 20"><path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" />
           </svg>
          </div>
         </div>
        </div>
        <div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-6 text-white">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-orange-100 text-sm">Tendik Aktif</p>
           <p id="dashboard-tendik" class="text-2xl font-bold">0</p>
          </div>
          <div class="bg-orange-400 bg-opacity-30 rounded-full p-3">
           <svg class="w-6 h-6" fill="currentColor" viewbox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z" />
           </svg>
          </div>
         </div>
        </div>
        <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-6 text-white">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-purple-100 text-sm">Total Kelas</p>
           <p id="dashboard-kelas" class="text-2xl font-bold">0</p>
          </div>
          <div class="bg-purple-400 bg-opacity-30 rounded-full p-3">
           <svg class="w-6 h-6" fill="currentColor" viewbox="0 0 20 20"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3z" />
           </svg>
          </div>
         </div>
        </div>
       </div><!-- Recent Activity -->
       <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="bg-gray-50 rounded-lg p-6">
         <h3 class="text-lg font-medium text-gray-900 mb-4">Data Terbaru</h3>
         <div id="recent-activity" class="space-y-3">
          <p class="text-gray-500 text-sm">Belum ada aktivitas terbaru</p>
         </div>
        </div>
        <div class="bg-gray-50 rounded-lg p-6">
         <h3 class="text-lg font-medium text-gray-900 mb-4">Ringkasan Sistem</h3>
         <div class="space-y-3">
          <div class="flex justify-between items-center"><span class="text-sm text-gray-600">Total Data Tersimpan</span> <span id="total-records" class="font-medium">0</span>
          </div>
          <div class="flex justify-between items-center"><span class="text-sm text-gray-600">Status Sistem</span> <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"> Aktif </span>
          </div>
          <div class="flex justify-between items-center"><span class="text-sm text-gray-600">Terakhir Update</span> <span id="last-update" class="text-sm text-gray-500">-</span>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div><!-- Data Siswa Section -->
     <div id="section-siswa" class="hidden">
      <div class="px-6 py-4 border-b border-gray-200">
       <div class="flex justify-between items-center">
        <h2 class="text-lg font-medium text-gray-900">Data Siswa</h2>
        <div class="flex space-x-2"><button onclick="downloadExcel('siswa')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg> Download Excel </button> <button onclick="showImportModal('siswa')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
          </svg> Import Excel/CSV </button> <button onclick="showAddForm('siswa')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"> + Tambah Siswa </button>
        </div>
       </div>
      </div><!-- Add Form Siswa -->
      <div id="form-siswa" class="hidden px-6 py-4 bg-gray-50 border-b">
       <form onsubmit="addData(event, 'siswa')" class="grid grid-cols-1 md:grid-cols-3 gap-4"><input type="text" id="nama-siswa" placeholder="Nama Lengkap" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nama-panggilan-siswa" placeholder="Nama Panggilan" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nis-siswa" placeholder="NIS" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nisn-siswa" placeholder="NISN" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <select id="jk-siswa" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <option value="">Pilih Jenis Kelamin</option> <option value="Laki-laki">Laki-laki</option> <option value="Perempuan">Perempuan</option> </select> <select id="agama-siswa" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <option value="">Pilih Agama</option> <option value="Islam">Islam</option> <option value="Kristen">Kristen</option> <option value="Katolik">Katolik</option> <option value="Hindu">Hindu</option> <option value="Buddha">Buddha</option> <option value="Konghucu">Konghucu</option> </select> <input type="text" id="tempat-lahir-siswa" placeholder="Tempat Lahir" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="date" id="tanggal-lahir-siswa" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <select id="kelas-siswa" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <option value="">Pilih Kelas</option> <option value="1A">1A</option> <option value="1B">1B</option> <option value="2A">2A</option> <option value="2B">2B</option> <option value="3A">3A</option> <option value="3B">3B</option> <option value="4A">4A</option> <option value="4B">4B</option> <option value="5A">5A</option> <option value="5B">5B</option> <option value="6A">6A</option> <option value="6B">6B</option> </select> <textarea id="alamat-siswa" placeholder="Alamat Lengkap" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 col-span-3 h-20 resize-none"></textarea> <input type="text" id="nama-ayah-siswa" placeholder="Nama Ayah" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nama-ibu-siswa" placeholder="Nama Ibu" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <div class="flex space-x-2 col-span-3"><button type="submit" id="submit-siswa" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center"> <span class="submit-text">Simpan</span>
          <div class="loading-spinner ml-2 hidden"></div></button> <button type="button" onclick="hideAddForm('siswa')" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium"> Batal </button>
        </div>
       </form>
      </div><!-- Table Siswa -->
      <div class="overflow-x-auto">
       <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
         <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NIS</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NISN</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">JK</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kelas</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Orang Tua</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
         </tr>
        </thead>
        <tbody id="table-siswa" class="bg-white divide-y divide-gray-200">
         <tr>
          <td colspan="6" class="px-6 py-8 text-center text-gray-500">Belum ada data siswa. Klik "Tambah Siswa" untuk menambah data.</td>
         </tr>
        </tbody>
       </table>
      </div>
     </div><!-- Data Guru Section -->
     <div id="section-guru" class="hidden">
      <div class="px-6 py-4 border-b border-gray-200">
       <div class="flex justify-between items-center">
        <h2 class="text-lg font-medium text-gray-900">Data Guru</h2>
        <div class="flex space-x-2"><button onclick="downloadExcel('guru')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg> Download Excel </button> <button onclick="showImportModal('guru')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
          </svg> Import Excel/CSV </button> <button onclick="showAddForm('guru')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"> + Tambah Guru </button>
        </div>
       </div>
      </div><!-- Add Form Guru -->
      <div id="form-guru" class="hidden px-6 py-4 bg-gray-50 border-b">
       <form onsubmit="addData(event, 'guru')" class="grid grid-cols-1 md:grid-cols-3 gap-4"><input type="text" id="nama-guru" placeholder="Nama Lengkap" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nik-guru" placeholder="NIK" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nuptk-guru" placeholder="NUPTK" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="tempat-lahir-guru" placeholder="Tempat Lahir" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="date" id="tanggal-lahir-guru" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="tel" id="no-telepon-guru" placeholder="No. Telepon (WA)" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="email" id="email-guru" placeholder="Email" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <select id="jabatan-guru" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <option value="">Pilih Jabatan</option> <option value="Guru Kelas">Guru Kelas</option> <option value="Guru Mata Pelajaran">Guru Mata Pelajaran</option> <option value="Guru Olahraga">Guru Olahraga</option> <option value="Guru Agama">Guru Agama</option> <option value="Guru Bahasa Inggris">Guru Bahasa Inggris</option> <option value="Kepala Sekolah">Kepala Sekolah</option> <option value="Wakil Kepala Sekolah">Wakil Kepala Sekolah</option> </select> <textarea id="alamat-guru" placeholder="Alamat Lengkap" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 col-span-3 h-20 resize-none"></textarea>
        <div class="flex space-x-2 col-span-3"><button type="submit" id="submit-guru" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center"> <span class="submit-text">Simpan</span>
          <div class="loading-spinner ml-2 hidden"></div></button> <button type="button" onclick="hideAddForm('guru')" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium"> Batal </button>
        </div>
       </form>
      </div><!-- Table Guru -->
      <div class="overflow-x-auto">
       <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
         <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NIK</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NUPTK</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jabatan</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No. Telepon</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
         </tr>
        </thead>
        <tbody id="table-guru" class="bg-white divide-y divide-gray-200">
         <tr>
          <td colspan="6" class="px-6 py-8 text-center text-gray-500">Belum ada data guru. Klik "Tambah Guru" untuk menambah data.</td>
         </tr>
        </tbody>
       </table>
      </div>
     </div><!-- Data Tendik Section -->
     <div id="section-tendik" class="hidden">
      <div class="px-6 py-4 border-b border-gray-200">
       <div class="flex justify-between items-center">
        <h2 class="text-lg font-medium text-gray-900">Data Tenaga Kependidikan</h2>
        <div class="flex space-x-2"><button onclick="downloadExcel('tendik')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg> Download Excel </button> <button onclick="showImportModal('tendik')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
          </svg> Import Excel/CSV </button> <button onclick="showAddForm('tendik')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"> + Tambah Tendik </button>
        </div>
       </div>
      </div><!-- Add Form Tendik -->
      <div id="form-tendik" class="hidden px-6 py-4 bg-gray-50 border-b">
       <form onsubmit="addData(event, 'tendik')" class="grid grid-cols-1 md:grid-cols-3 gap-4"><input type="text" id="nama-tendik" placeholder="Nama Lengkap" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nik-tendik" placeholder="NIK" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="nuptk-tendik" placeholder="NUPTK" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="tempat-lahir-tendik" placeholder="Tempat Lahir" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="date" id="tanggal-lahir-tendik" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="tel" id="no-telepon-tendik" placeholder="No. Telepon (WA)" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="email" id="email-tendik" placeholder="Email" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <select id="jabatan-tendik" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <option value="">Pilih Jabatan</option> <option value="Tata Usaha">Tata Usaha</option> <option value="Pustakawan">Pustakawan</option> <option value="Laboran">Laboran</option> <option value="Teknisi">Teknisi</option> <option value="Penjaga Sekolah">Penjaga Sekolah</option> <option value="Cleaning Service">Cleaning Service</option> <option value="Satpam">Satpam</option> <option value="Operator Sekolah">Operator Sekolah</option> </select> <textarea id="alamat-tendik" placeholder="Alamat Lengkap" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 col-span-3 h-20 resize-none"></textarea>
        <div class="flex space-x-2 col-span-3"><button type="submit" id="submit-tendik" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center"> <span class="submit-text">Simpan</span>
          <div class="loading-spinner ml-2 hidden"></div></button> <button type="button" onclick="hideAddForm('tendik')" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium"> Batal </button>
        </div>
       </form>
      </div><!-- Table Tendik -->
      <div class="overflow-x-auto">
       <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
         <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NIK</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NUPTK</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jabatan</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No. Telepon</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
         </tr>
        </thead>
        <tbody id="table-tendik" class="bg-white divide-y divide-gray-200">
         <tr>
          <td colspan="6" class="px-6 py-8 text-center text-gray-500">Belum ada data tendik. Klik "Tambah Tendik" untuk menambah data.</td>
         </tr>
        </tbody>
       </table>
      </div>
     </div><!-- Data Kelas Section -->
     <div id="section-kelas" class="hidden">
      <div class="px-6 py-4 border-b border-gray-200">
       <div class="flex justify-between items-center">
        <h2 class="text-lg font-medium text-gray-900">Data Kelas</h2>
        <div class="flex space-x-2"><button onclick="downloadExcel('kelas')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg> Download Excel </button> <button onclick="showImportModal('kelas')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
          </svg> Import Excel/CSV </button> <button onclick="showAddForm('kelas')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"> + Tambah Kelas </button>
        </div>
       </div>
      </div><!-- Add Form Kelas -->
      <div id="form-kelas" class="hidden px-6 py-4 bg-gray-50 border-b">
       <form onsubmit="addData(event, 'kelas')" class="grid grid-cols-1 md:grid-cols-4 gap-4"><input type="text" id="nama-kelas" placeholder="Nama Kelas (contoh: 1A)" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <input type="text" id="wali-kelas" placeholder="Wali Kelas" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <select id="tingkat-kelas" required class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"> <option value="">Pilih Tingkat</option> <option value="Kelas 1">Kelas 1</option> <option value="Kelas 2">Kelas 2</option> <option value="Kelas 3">Kelas 3</option> <option value="Kelas 4">Kelas 4</option> <option value="Kelas 5">Kelas 5</option> <option value="Kelas 6">Kelas 6</option> </select>
        <div class="flex space-x-2"><button type="submit" id="submit-kelas" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm font-medium flex items-center"> <span class="submit-text">Simpan</span>
          <div class="loading-spinner ml-2 hidden"></div></button> <button type="button" onclick="hideAddForm('kelas')" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium"> Batal </button>
        </div>
       </form>
      </div><!-- Table Kelas -->
      <div class="overflow-x-auto">
       <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
         <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Kelas</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Wali Kelas</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tingkat</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
         </tr>
        </thead>
        <tbody id="table-kelas" class="bg-white divide-y divide-gray-200">
         <tr>
          <td colspan="6" class="px-6 py-8 text-center text-gray-500">Belum ada data kelas. Klik "Tambah Kelas" untuk menambah data.</td>
         </tr>
        </tbody>
       </table>
      </div>
     </div><!-- Pengaturan Section -->
     <div id="section-pengaturan" class="hidden">
      <div class="px-6 py-4 border-b border-gray-200">
       <h2 class="text-lg font-medium text-gray-900">Pengaturan Dashboard</h2>
       <p class="text-sm text-gray-600 mt-1">Kelola informasi sekolah dan tampilan dashboard</p>
      </div>
      <div class="p-6">
       <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><!-- Informasi Sekolah -->
        <div class="bg-white border border-gray-200 rounded-lg p-6">
         <div class="flex items-center mb-4">
          <div class="bg-blue-100 p-2 rounded-lg mr-3">
           <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
           </svg>
          </div>
          <h3 class="text-lg font-medium text-gray-900">Informasi Sekolah</h3>
         </div>
         <form onsubmit="updateSchoolInfoForm(event)" class="space-y-4">
          <div><label for="setting-nama-sekolah" class="block text-sm font-medium text-gray-700 mb-2">Nama Sekolah</label> <input type="text" id="setting-nama-sekolah" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan nama sekolah">
          </div>
          <div><label for="setting-alamat-sekolah" class="block text-sm font-medium text-gray-700 mb-2">Alamat Sekolah</label> <textarea id="setting-alamat-sekolah" required rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none" placeholder="Masukkan alamat lengkap sekolah"></textarea>
          </div>
          <div><label for="setting-kepala-sekolah" class="block text-sm font-medium text-gray-700 mb-2">Nama Kepala Sekolah</label> <input type="text" id="setting-kepala-sekolah" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan nama kepala sekolah">
          </div><button type="submit" id="update-school-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center"> <span class="update-text">Simpan Perubahan</span>
           <div class="loading-spinner ml-2 hidden"></div></button>
         </form>
        </div><!-- Logo Sekolah -->
        <div class="bg-white border border-gray-200 rounded-lg p-6">
         <div class="flex items-center mb-4">
          <div class="bg-green-100 p-2 rounded-lg mr-3">
           <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
           </svg>
          </div>
          <h3 class="text-lg font-medium text-gray-900">Logo Sekolah</h3>
         </div><!-- Current Logo Display -->
         <div class="mb-4 text-center">
          <div id="current-logo" class="inline-flex items-center justify-center w-24 h-24 bg-blue-100 rounded-full mb-3">
           <svg class="w-12 h-12 text-blue-600" fill="currentColor" viewbox="0 0 20 20"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z" />
           </svg>
          </div>
          <p class="text-sm text-gray-600">Logo saat ini</p>
         </div><!-- Logo Upload -->
         <div class="space-y-4">
          <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors"><input type="file" id="logo-file" accept="image/*" class="hidden" onchange="handleLogoSelect(event)">
           <div id="logo-upload-area" class="cursor-pointer" onclick="document.getElementById('logo-file').click()">
            <svg class="mx-auto h-8 w-8 text-gray-400 mb-2" stroke="currentColor" fill="none" viewbox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <p class="text-sm text-gray-600"><span class="font-medium text-blue-600 hover:text-blue-500">Klik untuk upload logo</span></p>
            <p class="text-xs text-gray-500 mt-1">PNG, JPG, GIF (Max. 2MB)</p>
           </div>
          </div>
          <div id="logo-preview" class="hidden">
           <div class="flex items-center justify-between p-3 bg-green-50 rounded-md">
            <div class="flex items-center"><img id="logo-preview-img" src="" alt="Preview" class="w-10 h-10 object-cover rounded-md mr-3">
             <div>
              <p id="logo-file-name" class="text-sm font-medium text-green-700"></p>
              <p id="logo-file-size" class="text-xs text-green-600"></p>
             </div>
            </div><button onclick="clearLogo()" class="text-green-500 hover:text-green-700">
             <svg class="w-4 h-4" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
             </svg></button>
           </div><button onclick="uploadLogo()" id="upload-logo-btn" class="w-full mt-3 bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center"> <span class="upload-text">Upload Logo</span>
            <div class="loading-spinner ml-2 hidden"></div></button>
          </div><!-- Preset Icons -->
          <div class="border-t pt-4">
           <p class="text-sm font-medium text-gray-700 mb-3">Atau pilih ikon preset:</p>
           <div class="grid grid-cols-4 gap-2"><button onclick="selectPresetIcon('school')" class="preset-icon p-3 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors">
             <svg class="w-6 h-6 text-blue-600 mx-auto" fill="currentColor" viewbox="0 0 20 20"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3z" />
             </svg></button> <button onclick="selectPresetIcon('book')" class="preset-icon p-3 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors">
             <svg class="w-6 h-6 text-blue-600 mx-auto" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
             </svg></button> <button onclick="selectPresetIcon('graduation')" class="preset-icon p-3 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors">
             <svg class="w-6 h-6 text-blue-600 mx-auto" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z" /> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
             </svg></button> <button onclick="selectPresetIcon('star')" class="preset-icon p-3 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors">
             <svg class="w-6 h-6 text-blue-600 mx-auto" fill="currentColor" viewbox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
             </svg></button>
           </div>
          </div>
         </div>
        </div>
       </div><!-- Reset Settings -->
       <div class="mt-8 bg-red-50 border border-red-200 rounded-lg p-6">
        <div class="flex items-center mb-4">
         <div class="bg-red-100 p-2 rounded-lg mr-3">
          <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
          </svg>
         </div>
         <h3 class="text-lg font-medium text-red-900">Reset Pengaturan</h3>
        </div>
        <p class="text-sm text-red-700 mb-4">Kembalikan semua pengaturan ke nilai default. Tindakan ini tidak dapat dibatalkan.</p><button onclick="showResetConfirmation()" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md transition duration-200"> Reset ke Default </button>
       </div>
      </div>
     </div>
    </div>
   </main>
  </div><!-- Delete Confirmation Modal -->
  <div id="delete-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
   <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
    <div class="mt-3 text-center">
     <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
      <svg class="h-6 w-6 text-red-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
      </svg>
     </div>
     <h3 class="text-lg font-medium text-gray-900 mt-2">Konfirmasi Hapus</h3>
     <div class="mt-2 px-7 py-3">
      <p class="text-sm text-gray-500">Apakah Anda yakin ingin menghapus data ini? Tindakan ini tidak dapat dibatalkan.</p>
     </div>
     <div class="items-center px-4 py-3"><button id="confirm-delete" class="px-4 py-2 bg-red-500 text-white text-base font-medium rounded-md w-24 mr-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-300"> Hapus </button> <button onclick="hideDeleteModal()" class="px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md w-24 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300"> Batal </button>
     </div>
    </div>
   </div>
  </div><!-- Reset Confirmation Modal -->
  <div id="reset-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
   <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
    <div class="mt-3 text-center">
     <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
      <svg class="h-6 w-6 text-red-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
      </svg>
     </div>
     <h3 class="text-lg font-medium text-gray-900 mt-2">Reset Pengaturan</h3>
     <div class="mt-2 px-7 py-3">
      <p class="text-sm text-gray-500">Apakah Anda yakin ingin mereset semua pengaturan ke nilai default? Tindakan ini akan mengembalikan:</p>
      <ul class="text-sm text-gray-500 mt-2 text-left">
       <li>• Nama sekolah ke "SDN Merdeka 01"</li>
       <li>• Alamat ke alamat default</li>
       <li>• Nama kepala sekolah ke default</li>
       <li>• Logo ke ikon default</li>
      </ul>
     </div>
     <div class="items-center px-4 py-3"><button onclick="confirmReset()" class="px-4 py-2 bg-red-500 text-white text-base font-medium rounded-md w-24 mr-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-300"> Reset </button> <button onclick="hideResetModal()" class="px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md w-24 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300"> Batal </button>
     </div>
    </div>
   </div>
  </div><!-- Import Data Modal -->
  <div id="import-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
   <div class="relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white">
    <div class="mt-3">
     <div class="flex items-center justify-between mb-4">
      <div class="flex items-center">
       <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100">
        <svg class="h-6 w-6 text-green-600" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
        </svg>
       </div>
       <h3 id="import-title" class="text-lg font-medium text-gray-900 ml-3">Import Data</h3>
      </div><button onclick="hideImportModal()" class="text-gray-400 hover:text-gray-600">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
       </svg></button>
     </div>
     <div class="space-y-4"><!-- File Upload Area -->
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"><input type="file" id="import-file" accept=".xlsx,.xls,.csv" class="hidden" onchange="handleFileSelect(event)">
       <div id="upload-area" class="cursor-pointer" onclick="document.getElementById('import-file').click()">
        <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewbox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
        <div class="mt-4">
         <p class="text-sm text-gray-600"><span class="font-medium text-blue-600 hover:text-blue-500">Klik untuk upload file</span> atau drag &amp; drop</p>
         <p class="text-xs text-gray-500 mt-1">Excel (.xlsx, .xls) atau CSV (.csv)</p>
        </div>
       </div>
       <div id="file-info" class="hidden mt-4 p-3 bg-blue-50 rounded-md">
        <div class="flex items-center">
         <svg class="w-5 h-5 text-blue-500 mr-2" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
         </svg><span id="file-name" class="text-sm text-blue-700 font-medium"></span> <button onclick="clearFile()" class="ml-auto text-blue-500 hover:text-blue-700">
          <svg class="w-4 h-4" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
          </svg></button>
        </div>
       </div>
      </div><!-- Template Download -->
      <div class="bg-yellow-50 border border-yellow-200 rounded-md p-4">
       <div class="flex">
        <div class="flex-shrink-0">
         <svg class="h-5 w-5 text-yellow-400" viewbox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
         </svg>
        </div>
        <div class="ml-3">
         <h3 class="text-sm font-medium text-yellow-800">Format Template</h3>
         <div class="mt-2 text-sm text-yellow-700">
          <p>Download template Excel untuk memastikan format data yang benar:</p><button onclick="downloadTemplate()" class="mt-2 inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded text-yellow-800 bg-yellow-100 hover:bg-yellow-200">
           <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
           </svg> Download Template </button>
         </div>
        </div>
       </div>
      </div><!-- Preview Area -->
      <div id="preview-area" class="hidden">
       <h4 class="text-sm font-medium text-gray-900 mb-2">Preview Data (5 baris pertama):</h4>
       <div class="border rounded-md overflow-hidden">
        <div id="preview-table" class="overflow-x-auto max-h-64"></div>
       </div>
       <div class="mt-2 text-sm text-gray-600"><span id="total-rows">0</span> baris data ditemukan
       </div>
      </div><!-- Import Options -->
      <div id="import-options" class="hidden space-y-3">
       <div class="flex items-center"><input type="checkbox" id="skip-header" checked class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"> <label for="skip-header" class="ml-2 block text-sm text-gray-900"> Lewati baris pertama (header) </label>
       </div>
       <div class="flex items-center"><input type="checkbox" id="replace-data" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"> <label for="replace-data" class="ml-2 block text-sm text-gray-900"> Ganti semua data yang ada (hapus data lama) </label>
       </div>
      </div>
     </div><!-- Action Buttons -->
     <div class="flex justify-end space-x-3 mt-6 pt-4 border-t"><button onclick="hideImportModal()" class="px-4 py-2 bg-gray-500 text-white text-sm font-medium rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300"> Batal </button> <button id="import-btn" onclick="processImport()" disabled class="px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"> <span class="import-text">Import Data</span>
       <div class="loading-spinner ml-2 hidden"></div></button>
     </div>
    </div>
   </div>
  </div>
  <script>
        let allData = [];
        let currentRecordCount = 0;
        let deleteTarget = null;
        let currentTab = 'beranda';
        let importType = '';
        let importData = [];
        let selectedFile = null;
        let editMode = false;
        let editingRecord = null;

        // Konfigurasi default sekolah
        let schoolConfig = {
            nama_sekolah: "SDN Merdeka 01",
            alamat_sekolah: "Jl. Pendidikan No. 123, Jakarta",
            kepala_sekolah: "Drs. Ahmad Wijaya, M.Pd",
            logo_type: "preset",
            logo_preset: "school",
            logo_url: ""
        };

        // Load config dari localStorage jika ada
        function loadConfig() {
            const saved = localStorage.getItem('dapodik_school_config');
            if (saved) {
                try {
                    schoolConfig = { ...schoolConfig, ...JSON.parse(saved) };
                } catch (e) {
                    console.log('Error loading config, using defaults');
                }
            }
        }

        // Simpan config ke localStorage
        function saveConfig() {
            localStorage.setItem('dapodik_school_config', JSON.stringify(schoolConfig));
        }

        // Load data dari localStorage
        function loadData() {
            const saved = localStorage.getItem('dapodik_data');
            if (saved) {
                try {
                    allData = JSON.parse(saved);
                    currentRecordCount = allData.length;
                } catch (e) {
                    console.log('Error loading data, starting fresh');
                    allData = [];
                    currentRecordCount = 0;
                }
            }
        }

        // Simpan data ke localStorage
        function saveData() {
            localStorage.setItem('dapodik_data', JSON.stringify(allData));
        }

        function initApp() {
            loadConfig();
            loadData();
            updateSchoolInfo();
            updateStats();
            renderTable('siswa');
            renderTable('guru');
            renderTable('tendik');
            renderTable('kelas');
        }

        function updateSchoolInfo() {
            document.getElementById('nama-sekolah').textContent = schoolConfig.nama_sekolah;
            document.getElementById('alamat-sekolah').textContent = schoolConfig.alamat_sekolah;
            document.getElementById('kepala-sekolah').textContent = schoolConfig.kepala_sekolah;
            updateHeaderLogo();
        }

        function showTab(tabName) {
            currentTab = tabName;
            
            // Update tab buttons
            document.querySelectorAll('[id^="tab-"]').forEach(tab => {
                tab.className = "py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300";
            });
            document.getElementById(`tab-${tabName}`).className = "py-4 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600";
            
            // Update sections
            document.querySelectorAll('[id^="section-"]').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(`section-${tabName}`).classList.remove('hidden');
            document.getElementById(`section-${tabName}`).classList.add('fade-in');
            
            // Load settings form if switching to settings tab
            if (tabName === 'pengaturan') {
                updateSettingsForm();
            }
        }

        function showAddForm(type) {
            document.getElementById(`form-${type}`).classList.remove('hidden');
        }

        function hideAddForm(type) {
            document.getElementById(`form-${type}`).classList.add('hidden');
            document.getElementById(`form-${type}`).querySelector('form').reset();
            editMode = false;
            editingRecord = null;
            
            // Reset button text
            const submitBtn = document.getElementById(`submit-${type}`);
            const submitText = submitBtn.querySelector('.submit-text');
            submitText.textContent = 'Simpan';
        }

        function showEditForm(type, record) {
            editMode = true;
            editingRecord = record;
            
            // Show form
            showAddForm(type);
            
            // Change button text
            const submitBtn = document.getElementById(`submit-${type}`);
            const submitText = submitBtn.querySelector('.submit-text');
            submitText.textContent = 'Update';
            
            // Fill form with existing data
            fillEditForm(type, record);
        }

        function fillEditForm(type, record) {
            if (type === 'siswa') {
                document.getElementById('nama-siswa').value = record.nama || '';
                document.getElementById('nama-panggilan-siswa').value = record.nama_panggilan || '';
                document.getElementById('nis-siswa').value = record.nis || '';
                document.getElementById('nisn-siswa').value = record.nisn || '';
                document.getElementById('jk-siswa').value = record.jenis_kelamin || '';
                document.getElementById('agama-siswa').value = record.agama || '';
                document.getElementById('tempat-lahir-siswa').value = record.tempat_lahir || '';
                document.getElementById('tanggal-lahir-siswa').value = record.tanggal_lahir || '';
                document.getElementById('kelas-siswa').value = record.kelas_jabatan || '';
                document.getElementById('alamat-siswa').value = record.alamat || '';
                document.getElementById('nama-ayah-siswa').value = record.nama_ayah || '';
                document.getElementById('nama-ibu-siswa').value = record.nama_ibu || '';
            } else if (type === 'guru') {
                document.getElementById('nama-guru').value = record.nama || '';
                document.getElementById('nik-guru').value = record.nik || '';
                document.getElementById('nuptk-guru').value = record.nuptk || '';
                document.getElementById('tempat-lahir-guru').value = record.tempat_lahir || '';
                document.getElementById('tanggal-lahir-guru').value = record.tanggal_lahir || '';
                document.getElementById('no-telepon-guru').value = record.no_telepon || '';
                document.getElementById('email-guru').value = record.email || '';
                document.getElementById('jabatan-guru').value = record.kelas_jabatan || '';
                document.getElementById('alamat-guru').value = record.alamat || '';
            } else if (type === 'tendik') {
                document.getElementById('nama-tendik').value = record.nama || '';
                document.getElementById('nik-tendik').value = record.nik || '';
                document.getElementById('nuptk-tendik').value = record.nuptk || '';
                document.getElementById('tempat-lahir-tendik').value = record.tempat_lahir || '';
                document.getElementById('tanggal-lahir-tendik').value = record.tanggal_lahir || '';
                document.getElementById('no-telepon-tendik').value = record.no_telepon || '';
                document.getElementById('email-tendik').value = record.email || '';
                document.getElementById('jabatan-tendik').value = record.kelas_jabatan || '';
                document.getElementById('alamat-tendik').value = record.alamat || '';
            } else if (type === 'kelas') {
                document.getElementById('nama-kelas').value = record.nama || '';
                document.getElementById('wali-kelas').value = record.nip_nisn || '';
                document.getElementById('tingkat-kelas').value = record.kelas_jabatan || '';
            }
        }

        function addData(event, type) {
            event.preventDefault();
            
            // Check limit only for new records, not edits
            if (!editMode && currentRecordCount >= 999) {
                showNotification("Batas maksimum 999 data telah tercapai. Silakan hapus beberapa data terlebih dahulu.", "error");
                return;
            }

            const submitBtn = document.getElementById(`submit-${type}`);
            const submitText = submitBtn.querySelector('.submit-text');
            const spinner = submitBtn.querySelector('.loading-spinner');
            
            submitBtn.disabled = true;
            submitText.textContent = editMode ? 'Mengupdate...' : 'Menyimpan...';
            spinner.classList.remove('hidden');

            setTimeout(() => {
                try {
                    let data;
                    
                    if (editMode && editingRecord) {
                        // Update existing record
                        data = { ...editingRecord };
                        // Find and update in array
                        const index = allData.findIndex(item => item.id === editingRecord.id);
                        if (index !== -1) {
                            allData[index] = data;
                        }
                    } else {
                        // Create new record
                        data = {
                            id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                            type: type,
                            status: 'Aktif',
                            tanggal_input: new Date().toISOString()
                        };
                        allData.push(data);
                        currentRecordCount++;
                    }

                    // Update data fields based on type
                    if (type === 'siswa') {
                        data.nama = document.getElementById('nama-siswa').value;
                        data.nama_panggilan = document.getElementById('nama-panggilan-siswa').value;
                        data.nis = document.getElementById('nis-siswa').value;
                        data.nisn = document.getElementById('nisn-siswa').value;
                        data.jenis_kelamin = document.getElementById('jk-siswa').value;
                        data.agama = document.getElementById('agama-siswa').value;
                        data.tempat_lahir = document.getElementById('tempat-lahir-siswa').value;
                        data.tanggal_lahir = document.getElementById('tanggal-lahir-siswa').value;
                        data.alamat = document.getElementById('alamat-siswa').value;
                        data.nama_ayah = document.getElementById('nama-ayah-siswa').value;
                        data.nama_ibu = document.getElementById('nama-ibu-siswa').value;
                        data.kelas_jabatan = document.getElementById('kelas-siswa').value;
                    } else if (type === 'guru') {
                        data.nama = document.getElementById('nama-guru').value;
                        data.nik = document.getElementById('nik-guru').value;
                        data.nuptk = document.getElementById('nuptk-guru').value;
                        data.tempat_lahir = document.getElementById('tempat-lahir-guru').value;
                        data.tanggal_lahir = document.getElementById('tanggal-lahir-guru').value;
                        data.alamat = document.getElementById('alamat-guru').value;
                        data.no_telepon = document.getElementById('no-telepon-guru').value;
                        data.email = document.getElementById('email-guru').value;
                        data.kelas_jabatan = document.getElementById('jabatan-guru').value;
                    } else if (type === 'tendik') {
                        data.nama = document.getElementById('nama-tendik').value;
                        data.nik = document.getElementById('nik-tendik').value;
                        data.nuptk = document.getElementById('nuptk-tendik').value;
                        data.tempat_lahir = document.getElementById('tempat-lahir-tendik').value;
                        data.tanggal_lahir = document.getElementById('tanggal-lahir-tendik').value;
                        data.alamat = document.getElementById('alamat-tendik').value;
                        data.no_telepon = document.getElementById('no-telepon-tendik').value;
                        data.email = document.getElementById('email-tendik').value;
                        data.kelas_jabatan = document.getElementById('jabatan-tendik').value;
                    } else if (type === 'kelas') {
                        data.nama = document.getElementById('nama-kelas').value;
                        data.nip_nisn = document.getElementById('wali-kelas').value;
                        data.kelas_jabatan = document.getElementById('tingkat-kelas').value;
                    }

                    // Save to localStorage
                    saveData();
                    
                    // Update UI
                    updateStats();
                    renderTable(type);
                    
                    hideAddForm(type);
                    const action = editMode ? 'diperbarui' : 'ditambahkan';
                    showNotification(`Data ${type} berhasil ${action}!`, "success");

                } catch (error) {
                    console.error('Error in addData:', error);
                    showNotification('Terjadi kesalahan. Silakan coba lagi.', "error");
                } finally {
                    submitBtn.disabled = false;
                    submitText.textContent = 'Simpan';
                    spinner.classList.add('hidden');
                }
            }, 500);
        }

        function showDeleteModal(record) {
            deleteTarget = record;
            document.getElementById('delete-modal').classList.remove('hidden');
        }

        function hideDeleteModal() {
            deleteTarget = null;
            document.getElementById('delete-modal').classList.add('hidden');
        }

        document.getElementById('confirm-delete').onclick = function() {
            if (deleteTarget) {
                // Find and remove from array
                const index = allData.findIndex(item => item.id === deleteTarget.id);
                if (index !== -1) {
                    allData.splice(index, 1);
                    currentRecordCount--;
                    
                    // Save to localStorage
                    saveData();
                    
                    // Update UI
                    updateStats();
                    renderTable('siswa');
                    renderTable('guru');
                    renderTable('tendik');
                    renderTable('kelas');
                    
                    showNotification(`Data berhasil dihapus!`, "success");
                } else {
                    showNotification(`Gagal menghapus data. Silakan coba lagi.`, "error");
                }
            }
            hideDeleteModal();
        };

        function updateStats() {
            const siswaCount = allData.filter(item => item.type === 'siswa').length;
            const guruCount = allData.filter(item => item.type === 'guru').length;
            const tendikCount = allData.filter(item => item.type === 'tendik').length;
            const kelasCount = allData.filter(item => item.type === 'kelas').length;

            document.getElementById('total-siswa').textContent = siswaCount;
            document.getElementById('total-guru').textContent = guruCount;
            document.getElementById('total-tendik').textContent = tendikCount;
            document.getElementById('total-kelas').textContent = kelasCount;

            // Update dashboard cards
            document.getElementById('dashboard-siswa').textContent = siswaCount;
            document.getElementById('dashboard-guru').textContent = guruCount;
            document.getElementById('dashboard-tendik').textContent = tendikCount;
            document.getElementById('dashboard-kelas').textContent = kelasCount;
            document.getElementById('total-records').textContent = allData.length;
            document.getElementById('last-update').textContent = new Date().toLocaleString('id-ID');

            updateRecentActivity();
        }

        function updateRecentActivity() {
            const recentData = allData
                .sort((a, b) => new Date(b.tanggal_input) - new Date(a.tanggal_input))
                .slice(0, 5);

            const activityContainer = document.getElementById('recent-activity');
            
            if (recentData.length === 0) {
                activityContainer.innerHTML = '<p class="text-gray-500 text-sm">Belum ada aktivitas terbaru</p>';
                return;
            }

            activityContainer.innerHTML = recentData.map(item => {
                const date = new Date(item.tanggal_input);
                const typeLabel = {
                    'siswa': 'Siswa',
                    'guru': 'Guru', 
                    'tendik': 'Tendik',
                    'kelas': 'Kelas'
                };
                
                return `
                    <div class="flex items-center justify-between py-2 border-b border-gray-200 last:border-b-0">
                        <div>
                            <p class="text-sm font-medium text-gray-900">${item.nama}</p>
                            <p class="text-xs text-gray-500">Data ${typeLabel[item.type]} ditambahkan</p>
                        </div>
                        <span class="text-xs text-gray-400">${date.toLocaleDateString('id-ID')}</span>
                    </div>
                `;
            }).join('');
        }

        function renderTable(type) {
            const tableBody = document.getElementById(`table-${type}`);
            const filteredData = allData.filter(item => item.type === type);

            if (filteredData.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-8 text-center text-gray-500">
                            Belum ada data ${type}. Klik "Tambah ${type.charAt(0).toUpperCase() + type.slice(1)}" untuk menambah data.
                        </td>
                    </tr>
                `;
                return;
            }

            if (type === 'siswa') {
                tableBody.innerHTML = filteredData.map((item, index) => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${index + 1}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${item.nama}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nis || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nisn || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.jenis_kelamin || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kelas_jabatan}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nama_ayah || '-'} / ${item.nama_ibu || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                ${item.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="showEditForm('siswa', ${JSON.stringify(item).replace(/"/g, '&quot;')})" class="text-blue-600 hover:text-blue-900 mr-3">
                                Edit
                            </button>
                            <button onclick="showDeleteModal(${JSON.stringify(item).replace(/"/g, '&quot;')})" class="text-red-600 hover:text-red-900">
                                Hapus
                            </button>
                        </td>
                    </tr>
                `).join('');
            } else if (type === 'guru' || type === 'tendik') {
                tableBody.innerHTML = filteredData.map((item, index) => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${index + 1}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${item.nama}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nik || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nuptk || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kelas_jabatan}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.no_telepon || '-'}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                ${item.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="showEditForm('${type}', ${JSON.stringify(item).replace(/"/g, '&quot;')})" class="text-blue-600 hover:text-blue-900 mr-3">
                                Edit
                            </button>
                            <button onclick="showDeleteModal(${JSON.stringify(item).replace(/"/g, '&quot;')})" class="text-red-600 hover:text-red-900">
                                Hapus
                            </button>
                        </td>
                    </tr>
                `).join('');
            } else {
                tableBody.innerHTML = filteredData.map((item, index) => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${index + 1}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${item.nama}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nip_nisn}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kelas_jabatan}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                ${item.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="showEditForm('kelas', ${JSON.stringify(item).replace(/"/g, '&quot;')})" class="text-blue-600 hover:text-blue-900 mr-3">
                                Edit
                            </button>
                            <button onclick="showDeleteModal(${JSON.stringify(item).replace(/"/g, '&quot;')})" class="text-red-600 hover:text-red-900">
                                Hapus
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-md shadow-lg ${type === 'success' ? 'bg-green-500' : 'bg-red-500'} text-white`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Login functionality
        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('login-btn');
            const loginText = loginBtn.querySelector('.login-text');
            const spinner = loginBtn.querySelector('.loading-spinner');
            const errorDiv = document.getElementById('login-error');
            
            // Show loading state
            loginBtn.disabled = true;
            loginText.textContent = 'Memproses...';
            spinner.classList.remove('hidden');
            errorDiv.classList.add('hidden');
            
            // Simulate login process
            setTimeout(() => {
                if (username === 'admin' && password === 'admin123') {
                    // Save login state
                    localStorage.setItem('dapodik_logged_in', 'true');
                    localStorage.setItem('dapodik_login_time', new Date().toISOString());
                    
                    // Show main app
                    document.getElementById('login-page').classList.add('hidden');
                    document.getElementById('main-app').classList.remove('hidden');
                    
                    // Initialize the main app after successful login
                    initApp();
                    
                    showNotification('Login berhasil! Selamat datang di Sistem Dapodik.', 'success');
                } else {
                    // Show error
                    errorDiv.classList.remove('hidden');
                    loginBtn.disabled = false;
                    loginText.textContent = 'Masuk';
                    spinner.classList.add('hidden');
                }
            }, 1000);
        }
        
        function handleLogout() {
            // Clear login state
            localStorage.removeItem('dapodik_logged_in');
            localStorage.removeItem('dapodik_login_time');
            
            // Show login page
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
            
            // Reset form
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('login-error').classList.add('hidden');
            
            showNotification('Anda telah logout dari sistem.', 'success');
        }
        
        function checkLoginState() {
            const isLoggedIn = localStorage.getItem('dapodik_logged_in');
            
            if (isLoggedIn === 'true') {
                // User is logged in, show main app
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                return true;
            } else {
                // User is not logged in, show login page
                document.getElementById('login-page').classList.remove('hidden');
                document.getElementById('main-app').classList.add('hidden');
                return false;
            }
        }

        // Import functionality
        function showImportModal(type) {
            importType = type;
            const typeLabels = {
                'siswa': 'Siswa',
                'guru': 'Guru',
                'tendik': 'Tenaga Kependidikan',
                'kelas': 'Kelas'
            };
            document.getElementById('import-title').textContent = `Import Data ${typeLabels[type]}`;
            document.getElementById('import-modal').classList.remove('hidden');
            resetImportModal();
        }

        function hideImportModal() {
            document.getElementById('import-modal').classList.add('hidden');
            resetImportModal();
        }

        function resetImportModal() {
            selectedFile = null;
            importData = [];
            document.getElementById('import-file').value = '';
            document.getElementById('file-info').classList.add('hidden');
            document.getElementById('preview-area').classList.add('hidden');
            document.getElementById('import-options').classList.add('hidden');
            document.getElementById('import-btn').disabled = true;
            document.getElementById('upload-area').classList.remove('hidden');
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            selectedFile = file;
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('file-info').classList.remove('hidden');
            document.getElementById('upload-area').classList.add('hidden');

            // Process file
            processFile(file);
        }

        function clearFile() {
            resetImportModal();
        }

        function processFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    let data;
                    const fileName = file.name.toLowerCase();
                    
                    if (fileName.endsWith('.csv')) {
                        // Process CSV
                        data = parseCSV(e.target.result);
                        
                        importData = data;
                        showPreview(data);
                        document.getElementById('import-options').classList.remove('hidden');
                        document.getElementById('import-btn').disabled = false;
                    } else if (fileName.endsWith('.xlsx') || fileName.endsWith('.xls')) {
                        // Process Excel file
                        const workbook = XLSX.read(e.target.result, { type: 'array' });
                        const firstSheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[firstSheetName];
                        data = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        
                        importData = data;
                        showPreview(data);
                        document.getElementById('import-options').classList.remove('hidden');
                        document.getElementById('import-btn').disabled = false;
                    } else {
                        throw new Error('Format file tidak didukung. Gunakan file Excel (.xlsx, .xls) atau CSV.');
                    }
                    
                } catch (error) {
                    showNotification('Error membaca file: ' + error.message, 'error');
                    resetImportModal();
                }
            };

            // Read file based on type
            if (file.name.toLowerCase().endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }

        function parseCSV(text) {
            const lines = text.split('\n');
            const result = [];
            
            for (let line of lines) {
                if (line.trim()) {
                    // Simple CSV parsing - handles basic cases
                    const row = line.split(',').map(cell => cell.trim().replace(/^"|"$/g, ''));
                    result.push(row);
                }
            }
            
            return result;
        }

        function showPreview(data) {
            const previewData = data.slice(0, 6); // Show header + 5 rows
            const totalRows = data.length;
            
            document.getElementById('total-rows').textContent = totalRows - 1; // Exclude header
            
            let tableHTML = '<table class="min-w-full divide-y divide-gray-200 text-sm">';
            
            previewData.forEach((row, index) => {
                const isHeader = index === 0;
                tableHTML += `<tr class="${isHeader ? 'bg-gray-50' : 'bg-white'}">`;
                
                row.forEach(cell => {
                    const tag = isHeader ? 'th' : 'td';
                    const classes = isHeader 
                        ? 'px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider'
                        : 'px-3 py-2 whitespace-nowrap text-sm text-gray-900';
                    tableHTML += `<${tag} class="${classes}">${cell || '-'}</${tag}>`;
                });
                
                tableHTML += '</tr>';
            });
            
            tableHTML += '</table>';
            
            document.getElementById('preview-table').innerHTML = tableHTML;
            document.getElementById('preview-area').classList.remove('hidden');
        }

        function processImport() {
            if (!selectedFile || !importData.length) return;

            const importBtn = document.getElementById('import-btn');
            const importText = importBtn.querySelector('.import-text');
            const spinner = importBtn.querySelector('.loading-spinner');
            
            importBtn.disabled = true;
            importText.textContent = 'Mengimpor...';
            spinner.classList.remove('hidden');

            setTimeout(() => {
                try {
                    const skipHeader = document.getElementById('skip-header').checked;
                    const replaceData = document.getElementById('replace-data').checked;
                    
                    // If replace data is checked, delete existing data of this type
                    if (replaceData) {
                        const existingData = allData.filter(item => item.type === importType);
                        existingData.forEach(item => {
                            const index = allData.findIndex(d => d.id === item.id);
                            if (index !== -1) {
                                allData.splice(index, 1);
                                currentRecordCount--;
                            }
                        });
                    }

                    // Process import data
                    const dataToImport = skipHeader ? importData.slice(1) : importData;
                    let successCount = 0;
                    let errorCount = 0;

                    for (const row of dataToImport) {
                        if (currentRecordCount >= 999) {
                            showNotification(`Batas maksimum 999 data tercapai. ${successCount} data berhasil diimpor.`, 'error');
                            break;
                        }

                        try {
                            const record = mapRowToRecord(row, importType);
                            if (record) {
                                allData.push(record);
                                successCount++;
                                currentRecordCount++;
                            }
                        } catch (error) {
                            errorCount++;
                        }
                    }

                    // Save to localStorage
                    saveData();
                    
                    // Update UI
                    updateStats();
                    renderTable('siswa');
                    renderTable('guru');
                    renderTable('tendik');
                    renderTable('kelas');

                    hideImportModal();
                    
                    if (errorCount === 0) {
                        showNotification(`Berhasil mengimpor ${successCount} data ${importType}!`, 'success');
                    } else {
                        showNotification(`Import selesai: ${successCount} berhasil, ${errorCount} gagal.`, 'success');
                    }

                } catch (error) {
                    showNotification('Error saat mengimpor data: ' + error.message, 'error');
                } finally {
                    importBtn.disabled = false;
                    importText.textContent = 'Import Data';
                    spinner.classList.add('hidden');
                }
            }, 1000);
        }

        function mapRowToRecord(row, type) {
            if (!row || row.length === 0) return null;

            const baseRecord = {
                id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                type: type,
                status: 'Aktif',
                tanggal_input: new Date().toISOString()
            };

            if (type === 'siswa') {
                // Expected columns: Nama, Nama Panggilan, NIS, NISN, JK, Agama, Tempat Lahir, Tanggal Lahir, Kelas, Alamat, Nama Ayah, Nama Ibu
                return {
                    ...baseRecord,
                    nama: row[0] || '',
                    nama_panggilan: row[1] || '',
                    nis: row[2] || '',
                    nisn: row[3] || '',
                    jenis_kelamin: row[4] || '',
                    agama: row[5] || '',
                    tempat_lahir: row[6] || '',
                    tanggal_lahir: row[7] || '',
                    kelas_jabatan: row[8] || '',
                    alamat: row[9] || '',
                    nama_ayah: row[10] || '',
                    nama_ibu: row[11] || ''
                };
            } else if (type === 'guru') {
                // Expected columns: Nama, NIK, NUPTK, Tempat Lahir, Tanggal Lahir, No Telepon, Email, Jabatan, Alamat
                return {
                    ...baseRecord,
                    nama: row[0] || '',
                    nik: row[1] || '',
                    nuptk: row[2] || '',
                    tempat_lahir: row[3] || '',
                    tanggal_lahir: row[4] || '',
                    no_telepon: row[5] || '',
                    email: row[6] || '',
                    kelas_jabatan: row[7] || '',
                    alamat: row[8] || ''
                };
            } else if (type === 'tendik') {
                // Expected columns: Nama, NIK, NUPTK, Tempat Lahir, Tanggal Lahir, No Telepon, Email, Jabatan, Alamat
                return {
                    ...baseRecord,
                    nama: row[0] || '',
                    nik: row[1] || '',
                    nuptk: row[2] || '',
                    tempat_lahir: row[3] || '',
                    tanggal_lahir: row[4] || '',
                    no_telepon: row[5] || '',
                    email: row[6] || '',
                    kelas_jabatan: row[7] || '',
                    alamat: row[8] || ''
                };
            } else if (type === 'kelas') {
                // Expected columns: Nama Kelas, Wali Kelas, Tingkat
                return {
                    ...baseRecord,
                    nama: row[0] || '',
                    nip_nisn: row[1] || '',
                    kelas_jabatan: row[2] || ''
                };
            }

            return null;
        }

        // Simple Excel/CSV processing functions
        function parseExcelFile(file, callback) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // For CSV files
                    if (file.name.toLowerCase().endsWith('.csv')) {
                        const text = e.target.result;
                        const data = parseCSV(text);
                        callback(data);
                        return;
                    }
                    
                    // For Excel files - simplified parsing
                    showNotification('Untuk file Excel, silakan convert ke CSV terlebih dahulu atau gunakan template CSV.', 'error');
                } catch (error) {
                    showNotification('Error membaca file: ' + error.message, 'error');
                }
            };
            
            if (file.name.toLowerCase().endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }

        function downloadTemplate() {
            // Download Excel template
            downloadTemplateAsExcel();
        }

        function downloadTemplateAsExcel() {
            try {
                const templates = {
                    siswa: [
                        ['Nama', 'Nama Panggilan', 'NIS', 'NISN', 'Jenis Kelamin', 'Agama', 'Tempat Lahir', 'Tanggal Lahir', 'Kelas', 'Alamat', 'Nama Ayah', 'Nama Ibu'],
                        ['Ahmad Budi Santoso', 'Budi', '12345', '1234567890123456', 'Laki-laki', 'Islam', 'Jakarta', '2010-01-15', '1A', 'Jl. Merdeka No. 1, Jakarta Pusat', 'Ahmad Wijaya', 'Siti Nurhaliza'],
                        ['Sari Dewi Lestari', 'Sari', '12346', '1234567890123457', 'Perempuan', 'Islam', 'Bandung', '2010-03-20', '1A', 'Jl. Sudirman No. 25, Bandung', 'Dedi Lestari', 'Dewi Sartika']
                    ],
                    guru: [
                        ['Nama', 'NIK', 'NUPTK', 'Tempat Lahir', 'Tanggal Lahir', 'No Telepon', 'Email', 'Jabatan', 'Alamat'],
                        ['Siti Nurhaliza, S.Pd', '3201234567890123', '1234567890123456', 'Bandung', '1985-05-20', '081234567890', 'siti.nurhaliza@email.com', 'Guru Kelas', 'Jl. Pendidikan No. 5, Bandung'],
                        ['Ahmad Fauzi, S.Pd', '3201234567890124', '1234567890123457', 'Jakarta', '1982-03-15', '081234567891', 'ahmad.fauzi@email.com', 'Guru Mata Pelajaran', 'Jl. Guru No. 10, Jakarta']
                    ],
                    tendik: [
                        ['Nama', 'NIK', 'NUPTK', 'Tempat Lahir', 'Tanggal Lahir', 'No Telepon', 'Email', 'Jabatan', 'Alamat'],
                        ['Bambang Wijaya', '3201234567890128', '1234567890123461', 'Surabaya', '1980-03-10', '081234567895', 'bambang.wijaya@email.com', 'Tata Usaha', 'Jl. Admin No. 3, Surabaya'],
                        ['Sari Indah Lestari', '3201234567890129', '1234567890123462', 'Jakarta', '1983-07-22', '081234567896', 'sari.indah@email.com', 'Pustakawan', 'Jl. Perpustakaan No. 7, Jakarta']
                    ],
                    kelas: [
                        ['Nama Kelas', 'Wali Kelas', 'Tingkat'],
                        ['1A', 'Siti Nurhaliza, S.Pd', 'Kelas 1'],
                        ['1B', 'Ahmad Fauzi, S.Pd', 'Kelas 1']
                    ]
                };

                const templateData = templates[importType] || templates.siswa;
                
                // Create workbook and worksheet
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(templateData);

                // Set column widths
                const colWidths = templateData[0].map(() => ({ wch: 20 }));
                ws['!cols'] = colWidths;

                // Add worksheet to workbook
                const typeLabels = {
                    'siswa': 'Siswa',
                    'guru': 'Guru',
                    'tendik': 'Tendik',
                    'kelas': 'Kelas'
                };
                
                XLSX.utils.book_append_sheet(wb, ws, `Template ${typeLabels[importType]}`);

                // Generate filename
                const currentDate = new Date().toISOString().split('T')[0];
                const fileName = `Template_Data_${typeLabels[importType]}_${currentDate}.xlsx`;

                // Download file
                XLSX.writeFile(wb, fileName);
                
                showNotification(`Template ${typeLabels[importType]} berhasil didownload sebagai Excel! File: ${fileName}`, 'success');

            } catch (error) {
                console.error('Error downloading template:', error);
                showNotification('Terjadi kesalahan saat mendownload template. Menggunakan CSV sebagai alternatif.', 'error');
                downloadTemplateAsCSV();
            }
        }

        function downloadTemplateAsCSV() {
            const templates = {
                siswa: [
                    ['Nama', 'Nama Panggilan', 'NIS', 'NISN', 'Jenis Kelamin', 'Agama', 'Tempat Lahir', 'Tanggal Lahir', 'Kelas', 'Alamat', 'Nama Ayah', 'Nama Ibu'],
                    ['Ahmad Budi Santoso', 'Budi', '12345', '1234567890123456', 'Laki-laki', 'Islam', 'Jakarta', '2010-01-15', '1A', 'Jl. Merdeka No. 1, Jakarta Pusat', 'Ahmad Wijaya', 'Siti Nurhaliza'],
                    ['Sari Dewi Lestari', 'Sari', '12346', '1234567890123457', 'Perempuan', 'Islam', 'Bandung', '2010-03-20', '1A', 'Jl. Sudirman No. 25, Bandung', 'Dedi Lestari', 'Dewi Sartika']
                ],
                guru: [
                    ['Nama', 'NIK', 'NUPTK', 'Tempat Lahir', 'Tanggal Lahir', 'No Telepon', 'Email', 'Jabatan', 'Alamat'],
                    ['Siti Nurhaliza, S.Pd', '3201234567890123', '1234567890123456', 'Bandung', '1985-05-20', '081234567890', 'siti.nurhaliza@email.com', 'Guru Kelas', 'Jl. Pendidikan No. 5, Bandung'],
                    ['Ahmad Fauzi, S.Pd', '3201234567890124', '1234567890123457', 'Jakarta', '1982-03-15', '081234567891', 'ahmad.fauzi@email.com', 'Guru Mata Pelajaran', 'Jl. Guru No. 10, Jakarta']
                ],
                tendik: [
                    ['Nama', 'NIK', 'NUPTK', 'Tempat Lahir', 'Tanggal Lahir', 'No Telepon', 'Email', 'Jabatan', 'Alamat'],
                    ['Bambang Wijaya', '3201234567890128', '1234567890123461', 'Surabaya', '1980-03-10', '081234567895', 'bambang.wijaya@email.com', 'Tata Usaha', 'Jl. Admin No. 3, Surabaya'],
                    ['Sari Indah Lestari', '3201234567890129', '1234567890123462', 'Jakarta', '1983-07-22', '081234567896', 'sari.indah@email.com', 'Pustakawan', 'Jl. Perpustakaan No. 7, Jakarta']
                ],
                kelas: [
                    ['Nama Kelas', 'Wali Kelas', 'Tingkat'],
                    ['1A', 'Siti Nurhaliza, S.Pd', 'Kelas 1'],
                    ['1B', 'Ahmad Fauzi, S.Pd', 'Kelas 1']
                ]
            };

            const templateData = templates[importType] || templates.siswa;
            
            // Convert to CSV
            const csvContent = templateData.map(row => 
                row.map(cell => `"${cell}"`).join(',')
            ).join('\n');
            
            // Create and download CSV file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const typeLabels = {
                    'siswa': 'Siswa',
                    'guru': 'Guru',
                    'tendik': 'Tendik',
                    'kelas': 'Kelas'
                };
                
                const currentDate = new Date().toISOString().split('T')[0];
                const fileName = `Template_Data_${typeLabels[importType]}_${currentDate}.csv`;
                
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', fileName);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification(`Template ${typeLabels[importType]} berhasil didownload sebagai CSV! File: ${fileName}`, 'success');
            }
        }

        // Download Excel function
        function downloadExcel(type) {
            try {
                const typeLabels = {
                    'siswa': 'Siswa',
                    'guru': 'Guru',
                    'tendik': 'Tendik',
                    'kelas': 'Kelas'
                };

                // Get data for the specific type
                const filteredData = allData.filter(item => item.type === type);
                
                if (filteredData.length === 0) {
                    showNotification(`Tidak ada data ${typeLabels[type]} untuk didownload.`, 'error');
                    return;
                }

                // Prepare data for Excel
                let excelData = [];
                let headers = [];

                if (type === 'siswa') {
                    headers = ['No', 'Nama', 'Nama Panggilan', 'NIS', 'NISN', 'Jenis Kelamin', 'Agama', 'Tempat Lahir', 'Tanggal Lahir', 'Kelas', 'Alamat', 'Nama Ayah', 'Nama Ibu', 'Status', 'Tanggal Input'];
                    excelData = filteredData.map((item, index) => [
                        index + 1,
                        item.nama || '',
                        item.nama_panggilan || '',
                        item.nis || '',
                        item.nisn || '',
                        item.jenis_kelamin || '',
                        item.agama || '',
                        item.tempat_lahir || '',
                        item.tanggal_lahir || '',
                        item.kelas_jabatan || '',
                        item.alamat || '',
                        item.nama_ayah || '',
                        item.nama_ibu || '',
                        item.status || '',
                        new Date(item.tanggal_input).toLocaleDateString('id-ID')
                    ]);
                } else if (type === 'guru' || type === 'tendik') {
                    headers = ['No', 'Nama', 'NIK', 'NUPTK', 'Tempat Lahir', 'Tanggal Lahir', 'No Telepon', 'Email', 'Jabatan', 'Alamat', 'Status', 'Tanggal Input'];
                    excelData = filteredData.map((item, index) => [
                        index + 1,
                        item.nama || '',
                        item.nik || '',
                        item.nuptk || '',
                        item.tempat_lahir || '',
                        item.tanggal_lahir || '',
                        item.no_telepon || '',
                        item.email || '',
                        item.kelas_jabatan || '',
                        item.alamat || '',
                        item.status || '',
                        new Date(item.tanggal_input).toLocaleDateString('id-ID')
                    ]);
                } else if (type === 'kelas') {
                    headers = ['No', 'Nama Kelas', 'Wali Kelas', 'Tingkat', 'Status', 'Tanggal Input'];
                    excelData = filteredData.map((item, index) => [
                        index + 1,
                        item.nama || '',
                        item.nip_nisn || '',
                        item.kelas_jabatan || '',
                        item.status || '',
                        new Date(item.tanggal_input).toLocaleDateString('id-ID')
                    ]);
                }

                // Add headers to the beginning
                excelData.unshift(headers);

                // Create workbook and worksheet
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(excelData);

                // Set column widths
                const colWidths = headers.map(() => ({ wch: 15 }));
                ws['!cols'] = colWidths;

                // Add worksheet to workbook
                XLSX.utils.book_append_sheet(wb, ws, typeLabels[type]);

                // Generate filename
                const currentDate = new Date().toISOString().split('T')[0];
                const fileName = `Data_${typeLabels[type]}_${schoolConfig.nama_sekolah.replace(/\s+/g, '_')}_${currentDate}.xlsx`;

                // Download file
                XLSX.writeFile(wb, fileName);

                showNotification(`Data ${typeLabels[type]} berhasil didownload! File: ${fileName}`, 'success');

            } catch (error) {
                console.error('Error downloading Excel:', error);
                showNotification('Terjadi kesalahan saat mendownload file Excel. Silakan coba lagi.', 'error');
            }
        }

        // Settings Functions
        function updateSettingsForm() {
            document.getElementById('setting-nama-sekolah').value = schoolConfig.nama_sekolah;
            document.getElementById('setting-alamat-sekolah').value = schoolConfig.alamat_sekolah;
            document.getElementById('setting-kepala-sekolah').value = schoolConfig.kepala_sekolah;
            
            // Update current logo display
            updateCurrentLogoDisplay();
        }

        function updateCurrentLogoDisplay() {
            const currentLogo = document.getElementById('current-logo');
            const logoType = schoolConfig.logo_type;
            
            if (logoType === 'preset') {
                const presetIcon = schoolConfig.logo_preset;
                currentLogo.innerHTML = getPresetIconSVG(presetIcon);
            } else if (logoType === 'upload' && schoolConfig.logo_url) {
                currentLogo.innerHTML = `<img src="${schoolConfig.logo_url}" alt="Logo" class="w-12 h-12 object-cover rounded-full">`;
            } else {
                // Default icon
                currentLogo.innerHTML = getPresetIconSVG('school');
            }
        }

        function updateHeaderLogo() {
            const headerLogo = document.querySelector('header .bg-white.p-2.rounded-lg');
            const logoType = schoolConfig.logo_type;
            
            if (logoType === 'preset') {
                const presetIcon = schoolConfig.logo_preset;
                if (headerLogo) {
                    headerLogo.innerHTML = getPresetIconSVG(presetIcon, 'w-8 h-8 text-blue-600');
                }
            } else if (logoType === 'upload' && schoolConfig.logo_url) {
                if (headerLogo) {
                    headerLogo.innerHTML = `<img src="${schoolConfig.logo_url}" alt="Logo" class="w-8 h-8 object-cover rounded">`;
                }
            }
        }

        function getPresetIconSVG(iconType, classes = 'w-12 h-12 text-blue-600') {
            const icons = {
                school: `<svg class="${classes}" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/>
                </svg>`,
                book: `<svg class="${classes}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                </svg>`,
                graduation: `<svg class="${classes}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/>
                </svg>`,
                star: `<svg class="${classes}" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>`
            };
            return icons[iconType] || icons.school;
        }

        function updateSchoolInfoForm(event) {
            event.preventDefault();
            
            const updateBtn = document.getElementById('update-school-btn');
            const updateText = updateBtn.querySelector('.update-text');
            const spinner = updateBtn.querySelector('.loading-spinner');
            
            updateBtn.disabled = true;
            updateText.textContent = 'Menyimpan...';
            spinner.classList.remove('hidden');

            setTimeout(() => {
                schoolConfig.nama_sekolah = document.getElementById('setting-nama-sekolah').value;
                schoolConfig.alamat_sekolah = document.getElementById('setting-alamat-sekolah').value;
                schoolConfig.kepala_sekolah = document.getElementById('setting-kepala-sekolah').value;

                saveConfig();
                updateSchoolInfo();
                
                showNotification('Informasi sekolah berhasil diperbarui!', 'success');

                updateBtn.disabled = false;
                updateText.textContent = 'Simpan Perubahan';
                spinner.classList.add('hidden');
            }, 500);
        }

        function handleLogoSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Check file size (2MB limit)
            if (file.size > 2 * 1024 * 1024) {
                showNotification('Ukuran file terlalu besar. Maksimal 2MB.', 'error');
                return;
            }

            // Check file type
            if (!file.type.startsWith('image/')) {
                showNotification('File harus berupa gambar (PNG, JPG, GIF).', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('logo-preview-img').src = e.target.result;
                document.getElementById('logo-file-name').textContent = file.name;
                document.getElementById('logo-file-size').textContent = formatFileSize(file.size);
                document.getElementById('logo-preview').classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function clearLogo() {
            document.getElementById('logo-file').value = '';
            document.getElementById('logo-preview').classList.add('hidden');
        }

        function uploadLogo() {
            const fileInput = document.getElementById('logo-file');
            const file = fileInput.files[0];
            if (!file) return;

            const uploadBtn = document.getElementById('upload-logo-btn');
            const uploadText = uploadBtn.querySelector('.upload-text');
            const spinner = uploadBtn.querySelector('.loading-spinner');
            
            uploadBtn.disabled = true;
            uploadText.textContent = 'Mengupload...';
            spinner.classList.remove('hidden');

            try {
                // Convert to base64 for storage
                const reader = new FileReader();
                reader.onload = function(e) {
                    const logoUrl = e.target.result;
                    
                    schoolConfig.logo_type = 'upload';
                    schoolConfig.logo_url = logoUrl;
                    schoolConfig.logo_preset = '';
                    
                    saveConfig();
                    updateSchoolInfo();
                    updateCurrentLogoDisplay();
                    
                    showNotification('Logo berhasil diupload!', 'success');
                    clearLogo();

                    uploadBtn.disabled = false;
                    uploadText.textContent = 'Upload Logo';
                    spinner.classList.add('hidden');
                };
                reader.readAsDataURL(file);
            } catch (error) {
                showNotification('Gagal mengupload logo. Silakan coba lagi.', 'error');
                uploadBtn.disabled = false;
                uploadText.textContent = 'Upload Logo';
                spinner.classList.add('hidden');
            }
        }

        function selectPresetIcon(iconType) {
            // Update visual selection
            document.querySelectorAll('.preset-icon').forEach(btn => {
                btn.classList.remove('border-blue-500', 'bg-blue-50');
                btn.classList.add('border-gray-200');
            });
            event.target.closest('.preset-icon').classList.add('border-blue-500', 'bg-blue-50');
            event.target.closest('.preset-icon').classList.remove('border-gray-200');

            schoolConfig.logo_type = 'preset';
            schoolConfig.logo_preset = iconType;
            schoolConfig.logo_url = '';
            
            saveConfig();
            updateSchoolInfo();
            updateCurrentLogoDisplay();
            
            showNotification('Logo berhasil diubah!', 'success');
        }

        function showResetConfirmation() {
            document.getElementById('reset-modal').classList.remove('hidden');
        }

        function hideResetModal() {
            document.getElementById('reset-modal').classList.add('hidden');
        }

        function confirmReset() {
            schoolConfig = {
                nama_sekolah: "SDN Merdeka 01",
                alamat_sekolah: "Jl. Pendidikan No. 123, Jakarta",
                kepala_sekolah: "Drs. Ahmad Wijaya, M.Pd",
                logo_type: "preset",
                logo_preset: "school",
                logo_url: ""
            };
            
            saveConfig();
            updateSchoolInfo();
            updateSettingsForm();
            
            showNotification('Pengaturan berhasil direset ke default!', 'success');
            hideResetModal();
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in
            if (checkLoginState()) {
                // User is logged in, initialize the app
                initApp();
            }
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99367fa5e29aa5b9',t:'MTc2MTI3NzcwOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>